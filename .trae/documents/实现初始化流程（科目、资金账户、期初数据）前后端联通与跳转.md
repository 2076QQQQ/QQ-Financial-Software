## 目标
- 完整打通 UC02 会计科目、UC09 资金账户、UC04 期初数据的后端接口与前端流程。
- 前端从“设置向导/首页”跳转到各页面；完成试算平衡后设置初始化完成标志并解锁菜单。

## 现状与差异
- 后端已存在接口：
  - GET/POST `/api/settings/subjects`（server.ts:299-320）
  - GET/POST `/api/settings/fund-accounts`（server.ts:321-340）
  - POST `/api/settings/initial-data/trial-balance`（server.ts:259-288）
  - POST `/api/settings/initialization/complete`（server.ts:289-298）
- 前端页面：
  - `SubjectManagement.tsx` 使用 `mockData` 读写
  - `FundAccountManagement.tsx` 使用 `mockData` 读写
  - `InitialDataEntry.tsx` 使用前端试算与 `mockData`，并调用 `completeAccountBook`（错误，应调用初始化完成接口）
- 跳转：`SetupWizard.tsx`、各设置页的“完成并继续”按钮已就绪；`MainLayout.tsx` 以 `has_initial_balances` 锁定菜单逻辑已就绪。

## 变更方案
1. 前端 API 封装（不新增文件，扩展现有 `frontend/lib/api/auth.ts`）：
   - subjects：`getSubjects()`、`createSubject({ code, name, category, direction, parentId })`
   - fund-accounts：`getFundAccounts()`、`createFundAccount({ name, type, initialBalance, relatedSubjectCode })`、`updateFundAccount(id, payload)`、`deleteFundAccount(id)`（后端将补充 PUT/DELETE）
   - initialization：`trialBalance(items)`、`completeInitialization()`（调用 `/api/settings/initialization/complete`）

2. UC02 会计科目前端改造（`frontend/pages/settings/SubjectManagement.tsx`）：
   - 初始化时从后端 `getSubjects()` 加载。
   - 新增科目/子科目时调用 `createSubject(...)` 持久化；成功后刷新列表。
   - 保持现有本地编辑/删除逻辑（后端暂未提供编辑/删除）。

3. UC09 资金账户前端改造（`frontend/pages/settings/FundAccountManagement.tsx`）：
   - 初始化时从后端 `getFundAccounts()` 加载。
   - 新增账户时调用 `createFundAccount(...)`；编辑调用 `updateFundAccount(...)`；删除调用 `deleteFundAccount(id)`；成功后刷新列表。
   - 关联科目下拉仍基于后端 `getSubjects()` 过滤 1001/1002 末级科目。
   - 后端补充接口：PUT `/api/settings/fund-accounts`、DELETE `/api/settings/fund-accounts?id=...`。

4. UC04 期初数据与试算平衡（`frontend/pages/setup/InitialDataEntry.tsx`）：
   - 保存并试算：将科目期初借/贷构造成 `items`，调用 `trialBalance(items)`，以返回的 `success/difference` 控制弹窗或错误提示。
   - “确认完成期初初始化”：改为调用 `completeInitialization()` 设置 `has_initial_balances=true`，成功后返回首页；首页向导将消失、侧边栏解锁。

5. 跳转与解锁
   - 维持 `SetupWizard.tsx`、各设置页的“完成并继续”按钮跳转。
   - `MainLayout.tsx` 的 `isLocked={!status.company.has_initial_balances}` 已满足解锁规则。

## 验证
- 启动前后端，按 UC02→UC03→UC09→UC04 执行：
  - 新增子科目后刷新能看到；
  - 新增资金账户（银行/现金）后刷新列表；
  - 录入期初数据，点击“保存并试算”，后端返回平衡则弹成功；不平衡则提示差额；
  - 点击“确认完成期初初始化”，返回首页，设置清单消失，菜单解锁。

## 代码改动文件
- `frontend/lib/api/auth.ts`
- `frontend/pages/settings/SubjectManagement.tsx`
- `frontend/pages/settings/FundAccountManagement.tsx`
- `frontend/pages/setup/InitialDataEntry.tsx`
- `backend/server.ts`（增加资金账户 PUT/DELETE）

请确认，我将按以上方案实现并验证。